---
import ModalityIcon from "@/components/icons/common/ModalityIcon.astro";

interface Props {
    title: string;
    description: string;
    link?: string;
    date: string;
    company: string;
    keyPoints: string[];
    modality: string;
}

const { title, description, link, date, company, keyPoints, modality } =
    Astro.props;
---

<div
    class="relative mx-4 pb-8 group transition-all duration-500 ease-in-out hover:scale-[1.02]
    before:absolute before:left-[-35px] before:block before:h-full before:w-0.5
    before:bg-primary/20 before:content-['']
    lg:px-12 lg:pb-12 lg:grid lg:grid-cols-5 lg:gap-8"
>
    <!-- Timeline dot with glow effect -->
    <div
        class="absolute -left-[46px] top-2 w-6 h-6 bg-primary flex items-center justify-center
        rounded-full shadow-lg shadow-primary/30 bg-primary/70 sm:ring-8 ring-primaryDark/50 shrink-0
        group-hover:shadow-primary/70 group-hover:scale-110 transition-all duration-300
        before:absolute before:inset-0 before:rounded-full before:animate-ping"
    >
        <svg
            class="w-2.5 h-2.5 text-secondary"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="currentColor"
            viewBox="0 0 20 20"
        >
            <path
                d="M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"
            ></path>
        </svg>
    </div>

    <!-- Left side - Job info -->
    <div class="relative pb-8 lg:col-span-2 lg:pb-0">
        <div class="sticky top-4">
            <!-- Job Title -->
            <h3
                class="text-xl md:text-2xl font-bold bg-gradient-to-r from-primary to-primaryDark
                bg-clip-text text-transparent mb-2 leading-tight"
            >
                {title}
            </h3>

            <!-- Company Name -->
            <h4 class="font-semibold text-lg md:text-xl text-primaryDark mb-3">
                {company}
            </h4>

            <!-- Date with modern styling -->
            <time
                class="inline-flex items-center px-3 py-1 text-sm font-medium
                bg-gradient-to-r from-blue-950/20 to-blue-800/20 backdrop-blur-sm
                text-secondary rounded-full border border-blue-950
                shadow-md shadow-blue-950/20 transition-all duration-500 group-hover:shadow-blue-950/40"
            >
                <svg
                    class="w-4 h-4 mr-2 opacity-80 group-hover:opacity-100"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                >
                    <path
                        fill-rule="evenodd"
                        d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z"
                        clip-rule="evenodd"></path>
                </svg>
                {date}
            </time>
            <div class="mt-3">
                <span
                    class={`inline-flex items-center gap-x-2 px-3 py-1 text-sm font-semibold
                            text-secondary rounded-full shadow-md transition-all duration-500
                            ${
                                modality === "Remoto"
                                    ? "bg-gradient-to-r from-fuchsia-950/20 to-fuchsia-800/20 border border-fuchsia-950 shadow-fuchsia-950/20 group-hover:shadow-fuchsia-950/40"
                                    : modality === "Hibrido"
                                      ? "bg-gradient-to-r from-slate-500/20 to-slate-600/20 border border-slate-700 shadow-slate-700/20 group-hover:shadow-slate-700/40"
                                      : "bg-gradient-to-r from-yellow-950/20 to-yellow-800/20 border border-yellow-950 shadow-yellow-950/20 group-hover:shadow-yellow-950/40"
                            }`}
                >
                    <ModalityIcon
                        class="w-4 h-4 opacity-80 group-hover:opacity-100"
                    />
                    {modality}
                </span>
            </div>
        </div>
    </div>

    <!-- Right side - Description and link -->
    <div class="relative flex flex-col gap-4 md:col-span-3">
        <!-- Modern card container -->
        <div
            class="relative p-6 rounded-2xl bg-gradient-to-br from-primary/5 to-primaryDark/5 backdrop-blur-sm border
            border-primary/50 shadow-lg shadow-primaryDark/20 group-hover:shadow-xl group-hover:shadow-primaryDark/30
            group-hover:border-primary/70 transition-all duration-500"
        >
            <!-- Subtle gradient overlay -->
            <div
                class="absolute inset-0 rounded-2xl bg-gradient-to-br from-primary/5 to-transparent opacity-0
                group-hover:opacity-100 transition-opacity duration-500"
            >
            </div>

            <!-- Description -->
            <div
                class="relative z-10 text-base leading-relaxed text-secondary/90
                group-hover:text-secondary/100 transition-colors duration-300"
                title={description.length > 150 ? description : undefined}
            >
                {
                    description.length > 150
                        ? `${description.substring(0, 150)}...`
                        : description
                }
            </div>

            <!-- Achievements -->
            {
                keyPoints && keyPoints.length > 0 && (
                    <div class="relative z-10 mt-4">
                        <h5 class="text-sm font-semibold text-primary mb-3 flex items-center">
                            <svg
                                class="w-4 h-4 mr-2"
                                fill="currentColor"
                                viewBox="0 0 20 20"
                            >
                                <path
                                    fill-rule="evenodd"
                                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.293l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0
                                                 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z"
                                    clip-rule="evenodd"
                                />
                            </svg>
                            Contribuciones clave
                        </h5>
                        <ul class="space-y-3">
                            {keyPoints.map((keyPoint, index) => (
                                <li
                                    class="text-sm text-secondary/90 flex items-start
                                                group-hover:text-secondary transition-colors duration-300"
                                    style={`animation-delay: ${index * 0.1}s`}
                                >
                                    <span class="text-primary mr-2 text-xs">
                                        â–¸
                                    </span>
                                    {keyPoint}
                                </li>
                            ))}
                        </ul>
                    </div>
                )
            }
        </div>
    </div>
</div>

<style>
    @keyframes shimmer {
        100% {
            transform: translateX(100%) skewX(-12deg);
        }
    }
</style>
